(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11588,        328]
NotebookOptionsPosition[     10292,        299]
NotebookOutlinePosition[     10685,        315]
CellTagsIndexPosition[     10642,        312]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "calculate", " ", "the", " ", "base", " ", "state", " ", "of", " ", "Q", 
     " ", "in", " ", "the", " ", "case", " ", "that", " ", "v", 
     RowBox[{"(", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"+", 
         RowBox[{"-", "W"}]}], "/", "2"}]}], ")"}]}], "=", "0"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"v", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Gamma]d", " ", "y"}], ",", "0", ",", "0"}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Q", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Qxx", ",", "Qxy", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Qxy", ",", 
        RowBox[{"-", "Qxx"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"veqn", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Curl", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Eta]", " ", 
          RowBox[{"Laplacian", "[", 
           RowBox[{"v", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"a", " ", 
          RowBox[{"Div", "[", 
           RowBox[{"Q", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", "\[Rule]", 
        RowBox[{"a", " ", "\[Tau]a"}]}], "}"}]}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"v", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "-", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Grad", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eij", "=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"v", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "+", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Grad", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Qeqn", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Nu]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"Q", ",", "t"}], "]"}], "+", 
             RowBox[{
              RowBox[{"Grad", "[", 
               RowBox[{"Q", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ".", 
              "v"}], "+", 
             RowBox[{"Q", ".", "\[CapitalOmega]"}], "-", 
             RowBox[{"\[CapitalOmega]", ".", "Q"}]}], ")"}]}], "+", 
          RowBox[{"A", " ", "Q"}], "-", 
          RowBox[{"K", " ", 
           RowBox[{"Laplacian", "[", 
            RowBox[{"Q", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "-", 
          RowBox[{"\[Lambda]", " ", "\[Nu]", 
           RowBox[{"(", 
            RowBox[{"2", "Eij"}], " ", ")"}]}]}], "/.", 
         RowBox[{"K", "\[Rule]", 
          RowBox[{
           RowBox[{"ell", "^", "2"}], " ", "A"}]}]}], "/.", 
        RowBox[{"A", "\[Rule]", 
         RowBox[{"\[Nu]", "/", "\[Tau]"}]}]}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}], "/.", 
      RowBox[{"x", "\[Rule]", "0"}]}], "//", "Simplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.865550069985297*^9, 3.865550226153528*^9}, {
  3.865550425828786*^9, 3.865550435987359*^9}, {3.865550698147772*^9, 
  3.865550724541657*^9}, {3.865550964049336*^9, 3.8655509832957573`*^9}, {
  3.8665640428883038`*^9, 3.866564043153514*^9}, {3.8665646157619*^9, 
  3.866564668422576*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d2d015d6-5a61-4f66-b101-335aca6295c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"y", " ", "\[Gamma]d"}], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.865550202850774*^9, 3.8655502268506527`*^9}, 
   3.8655504367430773`*^9, 3.865551350499997*^9, 3.866564056665894*^9, {
   3.8665646542774076`*^9, 3.866564668775572*^9}, 3.866564699646489*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"0ea23027-570b-41de-80b2-60a91f4a4eb1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Qxx", ",", "Qxy", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Qxy", ",", 
     RowBox[{"-", "Qxx"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.865550202850774*^9, 3.8655502268506527`*^9}, 
   3.8655504367430773`*^9, 3.865551350499997*^9, 3.866564056665894*^9, {
   3.8665646542774076`*^9, 3.866564668775572*^9}, 3.866564699647687*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"40e21574-cb91-4088-9490-b7e65654fe00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.865550202850774*^9, 3.8655502268506527`*^9}, 
   3.8655504367430773`*^9, 3.865551350499997*^9, 3.866564056665894*^9, {
   3.8665646542774076`*^9, 3.866564668775572*^9}, 3.866564699673023*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"f515a4ef-a78a-42af-ac9a-32501ca11c97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "Qxy"}], " ", "\[Gamma]d", " ", "\[Nu]"}], "+", 
      FractionBox[
       RowBox[{"Qxx", " ", "\[Nu]"}], "\[Tau]"]}], ",", 
     FractionBox[
      RowBox[{"\[Nu]", " ", 
       RowBox[{"(", 
        RowBox[{"Qxy", "+", 
         RowBox[{"\[Gamma]d", " ", 
          RowBox[{"(", 
           RowBox[{"Qxx", "-", "\[Lambda]"}], ")"}], " ", "\[Tau]"}]}], 
        ")"}]}], "\[Tau]"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Nu]", " ", 
       RowBox[{"(", 
        RowBox[{"Qxy", "+", 
         RowBox[{"\[Gamma]d", " ", 
          RowBox[{"(", 
           RowBox[{"Qxx", "-", "\[Lambda]"}], ")"}], " ", "\[Tau]"}]}], 
        ")"}]}], "\[Tau]"], ",", 
     RowBox[{
      RowBox[{"Qxy", " ", "\[Gamma]d", " ", "\[Nu]"}], "-", 
      FractionBox[
       RowBox[{"Qxx", " ", "\[Nu]"}], "\[Tau]"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.865550202850774*^9, 3.8655502268506527`*^9}, 
   3.8655504367430773`*^9, 3.865551350499997*^9, 3.866564056665894*^9, {
   3.8665646542774076`*^9, 3.866564668775572*^9}, 3.866564699680666*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"7656510e-2bce-4b39-a90e-e1b910ce4bb8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Grad", "[", 
   RowBox[{"Q", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], ".", "v"}]], "Input",
 CellChangeTimes->{{3.8665646729530354`*^9, 3.866564673177039*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"a3b1d851-6578-43a9-9f7b-a4860ca2d162"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.865550253167376*^9, 3.865551350603801*^9, 3.8665640567938223`*^9, {
   3.8665646745804377`*^9, 3.866564699772106*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"fd7e3d5d-76f3-4552-8206-13ed2a66ccaf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Qeqn", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Qeqn", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"{", " ", 
    RowBox[{"Qxx", ",", "Qxy"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8655502814347467`*^9, 3.865550419742672*^9}, {
  3.865550449886894*^9, 3.8655504779676523`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f57406b2-eee0-43ac-a27d-e36722a1570d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Qxx", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Gamma]d", "2"], " ", "\[Lambda]", " ", 
       SuperscriptBox["\[Tau]", "2"]}], 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Gamma]d", "2"], " ", 
        SuperscriptBox["\[Tau]", "2"]}]}]]}], ",", 
    RowBox[{"Qxy", "\[Rule]", 
     FractionBox[
      RowBox[{"\[Gamma]d", " ", "\[Lambda]", " ", "\[Tau]"}], 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Gamma]d", "2"], " ", 
        SuperscriptBox["\[Tau]", "2"]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.865550464438354*^9, 3.8655504787316837`*^9}, 
   3.86555135061047*^9, 3.866564056802135*^9, 3.866564699778433*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"cc3c1deb-8955-47f1-929a-60d0bb88d27c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.865550493123356*^9, 3.865550497685392*^9}, 
   3.8655506814641*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"814c31ee-8142-4f44-bacc-da6609cd63df"]
},
WindowSize->{808, 674},
WindowMargins->{{63, Automatic}, {30, Automatic}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"eef09849-80fa-45ad-a954-ac1c3869cc88"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4392, 125, 220, "Input",ExpressionUUID->"d2d015d6-5a61-4f66-b101-335aca6295c1"],
Cell[4975, 149, 407, 7, 34, "Output",ExpressionUUID->"0ea23027-570b-41de-80b2-60a91f4a4eb1"],
Cell[5385, 158, 581, 13, 34, "Output",ExpressionUUID->"40e21574-cb91-4088-9490-b7e65654fe00"],
Cell[5969, 173, 375, 6, 34, "Output",ExpressionUUID->"f515a4ef-a78a-42af-ac9a-32501ca11c97"],
Cell[6347, 181, 1365, 37, 92, "Output",ExpressionUUID->"7656510e-2bce-4b39-a90e-e1b910ce4bb8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7749, 223, 311, 7, 30, "Input",ExpressionUUID->"a3b1d851-6578-43a9-9f7b-a4860ca2d162"],
Cell[8063, 232, 481, 12, 34, "Output",ExpressionUUID->"fd7e3d5d-76f3-4552-8206-13ed2a66ccaf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8581, 249, 639, 18, 30, "Input",ExpressionUUID->"f57406b2-eee0-43ac-a27d-e36722a1570d"],
Cell[9223, 269, 856, 22, 56, "Output",ExpressionUUID->"cc3c1deb-8955-47f1-929a-60d0bb88d27c"]
}, Open  ]],
Cell[10094, 294, 194, 3, 60, "Input",ExpressionUUID->"814c31ee-8142-4f44-bacc-da6609cd63df"]
}
]
*)

