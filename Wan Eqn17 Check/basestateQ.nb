(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10464,        311]
NotebookOptionsPosition[      9170,        282]
NotebookOutlinePosition[      9563,        298]
CellTagsIndexPosition[      9520,        295]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "calculate", " ", "the", " ", "base", " ", "state", " ", "of", " ", "Q", 
     " ", "in", " ", "the", " ", "case", " ", "that", " ", "v", 
     RowBox[{"(", 
      RowBox[{"y", "=", 
       RowBox[{
        RowBox[{"+", 
         RowBox[{"-", "W"}]}], "/", "2"}]}], ")"}]}], "=", "0"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"v", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Gamma]d", " ", 
       RowBox[{"y", "/", "2"}]}], ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
   
   RowBox[{"Q", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Qxx", ",", "Qxy"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Qxy", ",", 
        RowBox[{"-", "Qxx"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"veqn", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Curl", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Eta]", " ", 
          RowBox[{"Laplacian", "[", 
           RowBox[{"v", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "-", 
         RowBox[{"a", " ", 
          RowBox[{"Div", "[", 
           RowBox[{"Q", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", "\[Rule]", 
        RowBox[{"a", " ", "\[Tau]a"}]}], "}"}]}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"v", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "-", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Grad", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eij", "=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"Grad", "[", 
         RowBox[{"v", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "+", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Grad", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "]"}]}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Qeqn", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Nu]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"Q", ",", "t"}], "]"}], "+", 
             RowBox[{
              RowBox[{"Grad", "[", 
               RowBox[{"Q", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ".", "v"}], "+", 
             RowBox[{"Q", ".", "\[CapitalOmega]"}], "-", 
             RowBox[{"\[CapitalOmega]", ".", "Q"}]}], ")"}]}], "+", 
          RowBox[{"A", " ", "Q"}], "-", 
          RowBox[{"K", " ", 
           RowBox[{"Laplacian", "[", 
            RowBox[{"Q", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "-", 
          RowBox[{"\[Lambda]", " ", "\[Nu]", 
           RowBox[{"(", 
            RowBox[{"2", "Eij"}], " ", ")"}]}]}], "/.", 
         RowBox[{"K", "\[Rule]", 
          RowBox[{
           RowBox[{"ell", "^", "2"}], " ", "A"}]}]}], "/.", 
        RowBox[{"A", "\[Rule]", 
         RowBox[{"\[Nu]", "/", "\[Tau]"}]}]}], "/.", 
       RowBox[{"t", "\[Rule]", "0"}]}], "/.", 
      RowBox[{"x", "\[Rule]", "0"}]}], "//", "Simplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.865550069985297*^9, 3.865550226153528*^9}, {
  3.865550425828786*^9, 3.865550435987359*^9}, {3.865550698147772*^9, 
  3.865550724541657*^9}, {3.865550964049336*^9, 3.8655509832957573`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d2d015d6-5a61-4f66-b101-335aca6295c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"y", " ", "\[Gamma]d"}], "2"], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.865550202850774*^9, 3.8655502268506527`*^9}, 
   3.8655504367430773`*^9, 3.865551350499997*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"05a0dad5-4d74-45a8-bd91-9ba2310fc240"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Qxx", ",", "Qxy"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Qxy", ",", 
     RowBox[{"-", "Qxx"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.865550202850774*^9, 3.8655502268506527`*^9}, 
   3.8655504367430773`*^9, 3.865551350501224*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"a90e48ea-bda8-4da3-9727-c4c876668564"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.865550202850774*^9, 3.8655502268506527`*^9}, 
   3.8655504367430773`*^9, 3.8655513505281553`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"10a8dc3c-663a-498f-9888-4466e94fa01a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", "Qxy", " ", "\[Gamma]d", " ", "\[Nu]"}],
       "+", 
      FractionBox[
       RowBox[{"Qxx", " ", "\[Nu]"}], "\[Tau]"]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", "\[Gamma]d", " ", 
       RowBox[{"(", 
        RowBox[{"Qxx", "-", "\[Lambda]"}], ")"}], " ", "\[Nu]"}], "+", 
      FractionBox[
       RowBox[{"Qxy", " ", "\[Nu]"}], "\[Tau]"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", "\[Gamma]d", " ", 
       RowBox[{"(", 
        RowBox[{"Qxx", "-", "\[Lambda]"}], ")"}], " ", "\[Nu]"}], "+", 
      FractionBox[
       RowBox[{"Qxy", " ", "\[Nu]"}], "\[Tau]"]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"Qxy", " ", "\[Gamma]d", " ", "\[Nu]"}], "2"], "-", 
      FractionBox[
       RowBox[{"Qxx", " ", "\[Nu]"}], "\[Tau]"]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.865550202850774*^9, 3.8655502268506527`*^9}, 
   3.8655504367430773`*^9, 3.8655513505461693`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"28b425b8-9717-445e-afe1-37a01f29d609"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Grad", "[", 
   RowBox[{"Q", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ".", "v"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"a3b1d851-6578-43a9-9f7b-a4860ca2d162"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.865550253167376*^9, 3.865551350603801*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"2a082ae0-06f2-4a95-b658-950e9002c18f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Qeqn", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"Qeqn", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", "0"}]}], "}"}], 
   ",", 
   RowBox[{"{", " ", 
    RowBox[{"Qxx", ",", "Qxy"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8655502814347467`*^9, 3.865550419742672*^9}, {
  3.865550449886894*^9, 3.8655504779676523`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f57406b2-eee0-43ac-a27d-e36722a1570d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Qxx", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Gamma]d", "2"], " ", "\[Lambda]", " ", 
       SuperscriptBox["\[Tau]", "2"]}], 
      RowBox[{"4", "+", 
       RowBox[{
        SuperscriptBox["\[Gamma]d", "2"], " ", 
        SuperscriptBox["\[Tau]", "2"]}]}]]}], ",", 
    RowBox[{"Qxy", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", "\[Gamma]d", " ", "\[Lambda]", " ", "\[Tau]"}], 
      RowBox[{"4", "+", 
       RowBox[{
        SuperscriptBox["\[Gamma]d", "2"], " ", 
        SuperscriptBox["\[Tau]", "2"]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.865550464438354*^9, 3.8655504787316837`*^9}, 
   3.86555135061047*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"63607a6d-5ca7-44ad-9d6e-76f9c1a1709c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.865550493123356*^9, 3.865550497685392*^9}, 
   3.8655506814641*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"814c31ee-8142-4f44-bacc-da6609cd63df"]
},
WindowSize->{808, 674},
WindowMargins->{{63, Automatic}, {30, Automatic}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"eef09849-80fa-45ad-a954-ac1c3869cc88"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4102, 120, 199, "Input",ExpressionUUID->"d2d015d6-5a61-4f66-b101-335aca6295c1"],
Cell[4685, 144, 324, 7, 51, "Output",ExpressionUUID->"05a0dad5-4d74-45a8-bd91-9ba2310fc240"],
Cell[5012, 153, 396, 10, 34, "Output",ExpressionUUID->"a90e48ea-bda8-4da3-9727-c4c876668564"],
Cell[5411, 165, 226, 3, 34, "Output",ExpressionUUID->"10a8dc3c-663a-498f-9888-4466e94fa01a"],
Cell[5640, 170, 1230, 36, 52, "Output",ExpressionUUID->"28b425b8-9717-445e-afe1-37a01f29d609"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6907, 211, 233, 6, 30, "Input",ExpressionUUID->"a3b1d851-6578-43a9-9f7b-a4860ca2d162"],
Cell[7143, 219, 313, 8, 34, "Output",ExpressionUUID->"2a082ae0-06f2-4a95-b658-950e9002c18f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7493, 232, 639, 18, 30, "Input",ExpressionUUID->"f57406b2-eee0-43ac-a27d-e36722a1570d"],
Cell[8135, 252, 822, 22, 56, "Output",ExpressionUUID->"63607a6d-5ca7-44ad-9d6e-76f9c1a1709c"]
}, Open  ]],
Cell[8972, 277, 194, 3, 60, "Input",ExpressionUUID->"814c31ee-8142-4f44-bacc-da6609cd63df"]
}
]
*)

